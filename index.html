<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Cloudstack-cli by niwo</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Cloudstack-cli</h1>
        <h2>cloudstack-cli is a CloudStack API client written in Ruby</h2>
        <a href="https://github.com/niwo/cloudstack-cli" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a name="cloudstack-cli" class="anchor" href="#cloudstack-cli"><span class="octicon octicon-link"></span></a>Cloudstack CLI</h1>

<p><a href="http://badge.fury.io/rb/cloudstack-cli"><img src="https://badge.fury.io/rb/cloudstack-cli.png" alt="Gem Version"></a></p>

<p>cloudstack-cli is a <a href="http://cloudstack.apache.org/">CloudStack</a> API command line client written in Ruby.
cloudstack-cli uses the <a href="https://github.com/niwo/cloudstack_client">cloudstack_client</a> to talk to the Cloudstack API.</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Install the cloudstack-cli gem:</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>gem install cloudstack-cli
</pre></div>

<h2>
<a name="setup" class="anchor" href="#setup"><span class="octicon octicon-link"></span></a>Setup</h2>

<h3>
<a name="create-a-cloudstack-cli-environmet" class="anchor" href="#create-a-cloudstack-cli-environmet"><span class="octicon octicon-link"></span></a>Create a cloudstack-cli environmet</h3>

<p>Create your first environment, which defines your connection options:</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>cs environment add <span class="o">[</span>environment-name<span class="o">]</span>
</pre></div>

<p>cloudstack-cli expects to find a configuartion file with the API URL and your CloudStack credentials in your home directory named .cloudstack-cli.yml. If the file is located elsewhere you can specify the loaction using the --config option.</p>

<p>cloudstack-cli supports multiple environments using the --environment option.</p>

<p>see <code>cs help environment</code> for more options. </p>

<p>Example content of the configuration file:</p>

<div class="highlight highlight-yaml"><pre><span class="l-Scalar-Plain">:url</span><span class="p-Indicator">:</span>         <span class="s">"https://my-cloudstack-server/client/api/"</span>
<span class="l-Scalar-Plain">:api_key</span><span class="p-Indicator">:</span>     <span class="s">"cloudstack-api-key"</span>
<span class="l-Scalar-Plain">:secret_key</span><span class="p-Indicator">:</span>  <span class="s">"cloudstack-api-secret"</span>

<span class="l-Scalar-Plain">test</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">:url</span><span class="p-Indicator">:</span>           <span class="s">"http://my-cloudstack-testserver/client/api/"</span>
    <span class="l-Scalar-Plain">:api_key</span><span class="p-Indicator">:</span>       <span class="s">"cloudstack-api-key"</span>
    <span class="l-Scalar-Plain">:secret_key</span><span class="p-Indicator">:</span>    <span class="s">"cloudstack-api-secret"</span>
</pre></div>

<h3>
<a name="shell-tab-auto-completion" class="anchor" href="#shell-tab-auto-completion"><span class="octicon octicon-link"></span></a>Shell tab auto-completion</h3>

<p>To enable tab auto-completion for cloudstack-cli, add the following lines to your ~/.bash_profile file.</p>

<div class="highlight highlight-sh"><pre><span class="c"># Bash, ~/.bash_profile</span>
<span class="nb">eval</span> <span class="s2">"$(cs completion --shell=bash)"</span>
</pre></div>

<p><strong>Note</strong>: use <code>~/.bashrc</code> on Ubuntu</p>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>For additional documentation find the RubyDoc <a href="http://rubydoc.info/gems/cloudstack-cli/">here</a>.</p>

<p>See the help screen:</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>cs
</pre></div>

<h3>
<a name="example-bootsrapping-a-server" class="anchor" href="#example-bootsrapping-a-server"><span class="octicon octicon-link"></span></a>Example: Bootsrapping a server</h3>

<p>Bootsraps a server using a template and creating port-forwarding rules for port 22 and 80.</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>cs server create server-01 --template CentOS-6.4-x64-v1.4 --zone DC1 --offering 1cpu_1gb --port-rules :22 :80
</pre></div>

<h3>
<a name="example-run-a-any-custom-api-command" class="anchor" href="#example-run-a-any-custom-api-command"><span class="octicon octicon-link"></span></a>Example: Run a any custom API command</h3>

<p>Run the "listAlerts" command against the Cloudstack API with an argument of type=8:</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>cs <span class="nb">command </span>listAlerts <span class="nb">type</span><span class="o">=</span>8
</pre></div>

<h3>
<a name="example-creating-a-complete-stack-of-servers" class="anchor" href="#example-creating-a-complete-stack-of-servers"><span class="octicon octicon-link"></span></a>Example: Creating a complete stack of servers</h3>

<p>An example stackfile looks like this (my_stackfile.json)</p>

<div class="highlight highlight-json"><pre><span class="p">{</span>
    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"web_stack-a"</span><span class="p">,</span>
    <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"Web Application Stack"</span><span class="p">,</span>
    <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"1.0"</span><span class="p">,</span>
    <span class="nt">"zone"</span><span class="p">:</span> <span class="s2">"DC-BIE-1"</span><span class="p">,</span>
    <span class="nt">"group"</span><span class="p">:</span> <span class="s2">"my_web_stack"</span><span class="p">,</span>
    <span class="nt">"keypair"</span><span class="p">:</span> <span class="s2">"mykeypair"</span><span class="p">,</span>
    <span class="nt">"servers"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"web-d1, web-d2"</span><span class="p">,</span>
            <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"Web nodes"</span><span class="p">,</span>
            <span class="nt">"template"</span><span class="p">:</span> <span class="s2">"CentOS-6.4-x64-v1.2"</span><span class="p">,</span>
            <span class="nt">"offering"</span><span class="p">:</span> <span class="s2">"1cpu_1gb"</span><span class="p">,</span>
            <span class="nt">"networks"</span><span class="p">:</span> <span class="s2">"server_network"</span><span class="p">,</span>
            <span class="nt">"port_rules"</span><span class="p">:</span> <span class="s2">":80, :443"</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"db-01"</span><span class="p">,</span>
            <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"PostgreSQL Master"</span><span class="p">,</span>
            <span class="nt">"iso"</span><span class="p">:</span> <span class="s2">"CentOS-6.4-x86_64-swisstxt-v15"</span><span class="p">,</span>
            <span class="nt">"disk_offering"</span><span class="p">:</span> <span class="s2">"Perf Storage"</span><span class="p">,</span>
            <span class="nt">"disk_size"</span><span class="p">:</span> <span class="s2">"5"</span><span class="p">,</span>
            <span class="nt">"offering"</span><span class="p">:</span> <span class="s2">"2cpu_4gb"</span><span class="p">,</span>
            <span class="nt">"networks"</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">"server_network"</span><span class="p">,</span>
                <span class="s2">"storage_network"</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

<p>Create the stack of servers from above:</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>cs stack create my_stackfile.json
</pre></div>

<h3>
<a name="example-sort-computing-offerings" class="anchor" href="#example-sort-computing-offerings"><span class="octicon octicon-link"></span></a>Example: Sort computing offerings</h3>

<p>Sort all computing offerings by CPU and Memory grouped my Domain:</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>cs offering sort
</pre></div>

<h3>
<a name="example-stop-all-backup-routers-of-a-given-project" class="anchor" href="#example-stop-all-backup-routers-of-a-given-project"><span class="octicon octicon-link"></span></a>Example: Stop all backup routers of a given project</h3>

<p>Stop all virtual routers of project Demo (you could filter by zone too):
(This command is helpful if you have to deploy new versions of Cloudstack when using redundant routers)</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>cs router list --project Demo --status running --redundant-state BACKUP --command stop
</pre></div>

<p>Hint: You can watch the status of the command with watch.</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>watch -n cs router list --project Demo
</pre></div>

<h2>
<a name="references" class="anchor" href="#references"><span class="octicon octicon-link"></span></a>References</h2>

<ul>
<li> <a href="http://cloudstack.apache.org/docs/api/">Cloudstack API documentation</a>
</li>
<li> This tool was inspired by the Knife extension for Cloudstack: <a href="https://github.com/CloudStack-extras/knife-cloudstack">knife-cloudstack</a>
</li>
</ul><h2>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h2>

<ol>
<li>Fork it</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol><h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p>Released under the MIT License. See the <a href="https://raw.github.com/niwo/cloudstack-cli/master/LICENSE.txt">LICENSE</a> file for further details.</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/niwo/cloudstack-cli/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/niwo/cloudstack-cli/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/niwo/cloudstack-cli"></a> is maintained by <a href="https://github.com/niwo">niwo</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-43124138-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>